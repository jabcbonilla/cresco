<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>


  <!--<script type="text/javascript" src="./campos.js"></script>-->
  <title>Principal</title>
  <% include partials/head %>
</head>

<body>


  

    <nav class="navbar" id="barra">
      <a class="navbar-brand marca" href="/profile">CRESCO</a>
      <form class="form-inline">

        <a href="/profile" class="emailBarra">
          <%= user.local.email %>
            <br>
        </a>
        <a href="/logout" class="btn btn-light btn-sm btn-logout">
          Cerrar Sesión
        </a>

      </form>
      

    </nav>


  <hr>

  <!-- ENCUESTAS -->

  <div class="container">
    <div class="row">
      <!--Formulario-->
      <div class="col-md-5">
        <div class="card">
          <div class="card-body">
            <form>
              <div class="form-group">

                <h2 class="col-md-12 text-center mb-4">Almacenar nueva encuesta</h2>
                <input type="text" name="valor" placeholder="Escriba la sucursal" class="form-control mb-4">
                <input type="text" name="valor" placeholder="Escriba la pregunta" class="form-control mb-4">

                <h3 class="col-md-12 mb-3">Tipo de pregunta</h3>
                <div class="container text-center">
                  <div class="btn-group mb-4" role="group" aria-label="Basic example">
                    <button type="button" class="btn btn-primary">Selección simple</button>
                    <button type="button" class="btn btn-info">Selección múltiple</button>

                  </div>
                </div>

  <!-- FIN ENCUESTAS -->

                <!-- <div id="main">
<input type="button" id="btAdd" value="Añadir Elemento" class="bt" />
<input type="button" id="btRemove" value="Eliminar Elemento" class="bt" />
<input type="button" id="btRemoveAll" value="Eliminar Todo" class="bt" /><br />
</div>-->

                <div class="container">
                  <div class="row">

                    <h3 class="col-md-12 mb-3">Opciones</h3>
                    <input type="text" name="valor" placeholder="Escriba la opción" class="form-control col-md-7">
                    <input type="number" name="quantity" data-toggle="tooltip" data-placement="top" title="Especifique la cantidad de usuarios que elijieron esta opción" min="1" max="5" value="1" class="form-control col-md-3" style="left: 5px;">
                    <div id="main" class="col-md-2">
                      <button class="btn btn-success" id="btAdd" data-toggle="tooltip" data-placement="right" title="Añadir otra opción">+</button>
                    </div>

                  </div>
                </div>
              </div>

            </form>
            <button action="/agregar" method="POST" class="btn btn-warning btn-block" type="submit">Guardar encuesta</button>
          </div>
        </div>
      </div>



      <!--Lista-->
      <div class="col-md-7">
        <h2 class="text-center">Mis encuestas</h2>
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Pregunta</th>
              <th>Tipo</th>
              <th>Opciones</th>

            </tr>
          </thead>
          <tbody>
            <% for(var i = 0; i < tasks.length; i++){ %>
              <tr>

                <td>
                  <%= tasks[i].pregunta %> <br>
                 <strong>Opciones:</strong> <br>
                  <%= tasks[i].opc1 %> <br>
                  <%= tasks[i].opc2 %> <br>
                  <%= tasks[i].opc3 %> <br>
                  <%= tasks[i].opc4 %>
                </td>
                <td>
                  <%= tasks[i].tipo %>
                </td>
                <td>
                  <div class="container">

                    <input type="radio" name="graficType" value="bar" onclick="func(this.value)"> Barra
                    <br>
                    <input type="radio" name="graficType" value="polarArea" onclick="func(this.value)"> Área polar
                    <br>
                    <input type="radio" name="graficType" value="doughnut" onclick="func(this.value)"> Dona
                    <br>
                    <input type="radio" name="graficType" value="pie" onclick="func(this.value)"> Torta
                    <br>
                  </div>
                  <a href="/eliminar/<%= tasks[i]._id %>" class="btn btn-danger">Eliminar</a>

                </td>
              </tr>
              <% } %>
          </tbody>

        </table>
      </div>


    </div>
  </div>


  <div class="chart-container" style="position: relative; left: 25%; height:20vh; width:50vw">
    <canvas id="myChart"></canvas>
    <script>
      var ctx = document.getElementById('myChart').getContext('2d');
      var myChart;

      function func(tipo) {

        cargargrafico(tipo);
      };

      function cargargrafico(tipo) {
        myChart = Chart;
        var chart = new Chart(ctx, {
          // The type of chart we want to create
          type: tipo,

          // The data for our dataset
          data: {
            labels: ['<%= tasks[0].opc1 %>', '<%= tasks[0].opc2 %>', '<%= tasks[0].opc3 %>', '<%= tasks[0].opc4 %>'],
            datasets: [{
              label: ['<%= tasks[0].pregunta %>'],

              backgroundColor: ['rgb(0, 255, 39)', 'rgb(243, 255, 0)', 'rgb(255, 87, 51)', 'rgb(255, 0, 0)'],
              borderColor: 'rgb(255, 255, 255)',
              data: [<%=tasks[0].cant1 %>, <%=tasks[0].cant2 %>, <%=tasks[0].cant3 %>, <%=tasks[0].cant4 %>],

            },

            ]
          },

          // Configuration options go here

          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });
      }
    </script>
  </div>
</body>

</html>